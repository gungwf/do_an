<div class="inventory-page">
  <div class="container-fluid px-4 py-4">
    
    <!-- Header - Đơn giản hóa -->
    <div class="page-header mb-4">
      <h2 class="page-title mb-1">
        <i class="bi bi-box-seam-fill text-primary me-2"></i>
        Quản lý Kho Thuốc
      </h2>
      <p class="text-muted mb-0">Chi nhánh của bạn</p>
    </div>

    <!-- Search Bar - Giống trang sản phẩm -->
    <div class="search-section mb-4">
      <div class="row g-3">
        
        <!-- Search Input -->
        <div class="col-lg-8 col-md-7">
          <div class="search-wrapper">
            <i class="bi bi-search"></i>
            <input 
              type="text" 
              class="form-control search-input" 
              placeholder="Tìm kiếm sản phẩm..."
              [(ngModel)]="searchTerm"
              (keyup.enter)="onSearch()">
            <button 
              *ngIf="searchTerm" 
              class="clear-btn"
              (click)="clearSearch()">
              <i class="bi bi-x-circle"></i>
            </button>
          </div>
        </div>

        <!-- Page Size & View Toggle -->
        <div class="col-lg-4 col-md-5">
          <div class="d-flex gap-2">
            <!-- Items per page -->
            <select 
              class="form-select" 
              [(ngModel)]="pageSize"
              (change)="onPageSizeChange()">
              <option [value]="8">8 / trang</option>
              <option [value]="12">12 / trang</option>
              <option [value]="24">24 / trang</option>
            </select>
            
            <!-- View toggle -->
            <!-- <div class="btn-group view-toggle" role="group">
              <button 
                class="btn"
                [class.active]="viewMode === 'grid'"
                (click)="viewMode = 'grid'">
                <i class="bi bi-grid-3x3-gap"></i>
              </button>
              <button 
                class="btn"
                [class.active]="viewMode === 'list'"
                (click)="viewMode = 'list'">
                <i class="bi bi-list-ul"></i>
              </button>
            </div> -->
          </div>
        </div>

      </div>
    </div>

    <!-- Stats Cards - Compact -->
    <div class="stats-section mb-4">
      <div class="row g-3">
        <div class="col-6 col-md-3">
          <div class="stat-card">
            <div class="stat-icon bg-primary-soft">
              <i class="bi bi-box-seam text-primary"></i>
            </div>
            <div class="stat-info">
              <h4 class="mb-0">{{ totalElements }}</h4>
              <p class="mb-0 text-muted small">Tổng sản phẩm</p>
            </div>
          </div>
        </div>
        <div class="col-6 col-md-3">
          <div class="stat-card">
            <div class="stat-icon bg-success-soft">
              <i class="bi bi-check-circle text-success"></i>
            </div>
            <div class="stat-info">
              <h4 class="mb-0">{{ availableCount }}</h4>
              <p class="mb-0 text-muted small">Còn hàng</p>
            </div>
          </div>
        </div>
        <div class="col-6 col-md-3">
          <div class="stat-card">
            <div class="stat-icon bg-warning-soft">
              <i class="bi bi-exclamation-triangle text-warning"></i>
            </div>
            <div class="stat-info">
              <h4 class="mb-0">{{ lowStockCount }}</h4>
              <p class="mb-0 text-muted small">Sắp hết</p>
            </div>
          </div>
        </div>
        <div class="col-6 col-md-3">
          <div class="stat-card">
            <div class="stat-icon bg-danger-soft">
              <i class="bi bi-x-circle text-danger"></i>
            </div>
            <div class="stat-info">
              <h4 class="mb-0">{{ outOfStockCount }}</h4>
              <p class="mb-0 text-muted small">Hết hàng</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Loading -->
    <div *ngIf="isLoading" class="loading-section text-center py-5">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <p class="mt-3 text-muted">Đang tải dữ liệu...</p>
    </div>

    <!-- Products Grid -->
    <div class="products-grid mb-4" *ngIf="!isLoading && inventoryItems.length > 0">
    <div class="row g-3">
      <div 
        class="col-xl-3 col-lg-4 col-md-6 col-6"
        *ngFor="let item of inventoryItems"
        data-aos="fade-up">
        <app-inventory-card
          [item]="item"
          (viewDetail)="onViewDetail($event)"
          (stockUpdate)="onStockUpdate($event)"
          (delete)="onDelete($event)">
        </app-inventory-card>
      </div>
    </div>
  </div>

    <!-- Empty State -->
    <div *ngIf="!isLoading && inventoryItems.length === 0" class="empty-state text-center py-5">
      <i class="bi bi-inbox display-1 text-muted mb-3"></i>
      <h4 class="text-muted">Không tìm thấy sản phẩm</h4>
      <p class="text-muted">Thử thay đổi từ khóa tìm kiếm hoặc bộ lọc</p>
      <button class="btn btn-primary mt-3" (click)="clearSearch()">
        <i class="bi bi-arrow-counterclockwise me-2"></i>
        Làm mới
      </button>
    </div>

    <!-- Pagination - Clean -->
    <div class="pagination-section" *ngIf="!isLoading && totalPages > 1">
      <nav aria-label="Pagination">
        <ul class="pagination justify-content-center mb-3">
          
          <!-- Previous -->
          <li class="page-item" [class.disabled]="currentPage === 0">
            <a class="page-link" (click)="previousPage()">
              <i class="bi bi-chevron-left"></i>
            </a>
          </li>

          <!-- First page -->
          <li class="page-item" [class.active]="currentPage === 0">
            <a class="page-link" (click)="goToPage(0)">1</a>
          </li>

          <!-- Dots -->
          <li class="page-item disabled" *ngIf="getPageNumbers()[0] > 1">
            <span class="page-link">...</span>
          </li>

          <!-- Middle pages -->
          <li 
            class="page-item" 
            [class.active]="currentPage === pageNum"
            *ngFor="let pageNum of getPageNumbers()">
            <a class="page-link" (click)="goToPage(pageNum)">
              {{ pageNum + 1 }}
            </a>
          </li>

          <!-- Dots -->
          <li class="page-item disabled" *ngIf="getPageNumbers()[getPageNumbers().length - 1] < totalPages - 2">
            <span class="page-link">...</span>
          </li>

          <!-- Last page -->
          <li class="page-item" [class.active]="currentPage === totalPages - 1" *ngIf="totalPages > 1">
            <a class="page-link" (click)="goToPage(totalPages - 1)">
              {{ totalPages }}
            </a>
          </li>

          <!-- Next -->
          <li class="page-item" [class.disabled]="currentPage >= totalPages - 1">
            <a class="page-link" (click)="nextPage()">
              <i class="bi bi-chevron-right"></i>
            </a>
          </li>

        </ul>
      </nav>

      <!-- Page info -->
      <div class="page-info text-center text-muted small">
        Hiển thị {{ startIndex }} - {{ endIndex }} trong {{ totalElements }} sản phẩm
      </div>
    </div>

  </div>
</div>
<app-stock-update-modal
  [item]="selectedItem"
  [isVisible]="showStockModal"
  (close)="onCloseModal()"
  (confirm)="onConfirmStockUpdate($event)">
</app-stock-update-modal>